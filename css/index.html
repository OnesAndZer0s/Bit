<html>
  <head>
    <title>Bit - CSS</title>
    <script src="../Blockly/blockly_compressed.js"></script>
    <script src="../Blockly/blocks_compressed.js"></script>
    <script src="../Blockly/javascript_compressed.js"></script>
    <script src="../Blockly/msg/en.js"></script>
    <script src="css_blocks.js"></script>
  </head>
  
  <body>
<div id="blocklyArea" style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%">
<div id="blocklyDiv" style="position: absolute"></div>
</div>

<xml id="toolbox" style="display: none">
	<category name="Selector">
	<block type="css_block"></block>
	<block type="css_class_selector"></block>
	<block type="css_id_selector"></block>
	<block type="css_join_selectors"></block>
	<block type="css_descendant_selectors"></block>
	<block type="css_allelement_selectors"></block>
	<block type="css_element_selectors"></block>
	<block type="css_parent_selectors"></block>
	<block type="css_after_selectors"></block>
	<block type="css_preceded_selectors"></block>
	<block type="css_not_selectors"></block>
	<block type="css_attribute_selectors"></block>
	<block type="css_attribute_with_selectors"></block>
	<block type="css_attribute_containing_selectors"></block>
	<block type="css_attribute_starting_selectors"></block>
	<block type="css_attribute_begins_selectors"></block>
	<block type="css_attribute_ends_selectors"></block>
	<block type="css_attribute_substring_selectors"></block>
	<block type="css_pseudo_selectors"></block>
        </category>
	<category name="Declaration"></category>
</xml>
    
	  <textarea id="textarea"></textarea>
<script>
  var blocklyArea = document.getElementById('blocklyArea');
  var blocklyDiv = document.getElementById('blocklyDiv');
  var workspace = Blockly.inject(blocklyDiv,{
  toolbox: document.getElementById('toolbox'),
  collapse : false, 
	comments : true, 
	disable : true, 
	maxBlocks : Infinity, 
	trashcan : true, 
	horizontalLayout : false, 
	toolboxPosition : 'start', 
	css : true, 
	scrollbars : true, 
	sounds : true, 
	oneBasedIndex : false, 
	grid : {
		spacing : 20, 
		length : 1, 
		colour : '#888', 
		snap : false
	}, 
	zoom : {
		controls : true, 
		wheel : true, 
		startScale : 1, 
		maxScale : 1.5, 
		minScale : 0.2, 
		scaleSpeed : 1.2
	}
});
  var onresize = function(e) {
    // Compute the absolute coordinates and dimensions of blocklyArea.
    var element = blocklyArea;
    var x = 0;
    var y = 0;
    do {
      x += element.offsetLeft;
      y += element.offsetTop;
      element = element.offsetParent;
    } while (element);
    // Position blocklyDiv over blocklyArea.
    blocklyDiv.style.left = x + 'px';
    blocklyDiv.style.top = y + 'px';
    blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
    blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
    Blockly.svgResize(workspace);
  };
  window.addEventListener('resize', onresize, false);
  onresize();
  Blockly.svgResize(workspace);
	
function myUpdateFunction(event) {
  var code = Blockly.JavaScript.workspaceToCode(workspace);
  document.getElementById('textarea').value = code;
	console.log(code);
}
workspace.addChangeListener(myUpdateFunction);
</script>
  </body>


</html>
