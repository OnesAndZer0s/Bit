<html>
  <head>
    <title>Bit - CSS</title>
    <script src="Blockly/blockly_compressed.js"></script>
    <script src="Blockly/blocks_compressed.js"></script>
    <script src="Blockly/javascript_compressed.js"></script>
    <script src="Blockly/msg/en.js"></script>

  </head>
  
  <body>
<div id="blocklyArea" style="position: absolute; width:500px; height:500px">
<div id="blocklyDiv" style="position: absolute"></div>
</div>

<xml id="toolbox" style="display: none">
  <block type="controls_if"></block>
  <block type="controls_whileUntil"></block>
</xml>
    
	  <textarea id="textarea"></textarea>
<script>
  var blocklyArea = document.getElementById('blocklyArea');
  var blocklyDiv = document.getElementById('blocklyDiv');
  var workspace = Blockly.inject(blocklyDiv,{
  toolbox: document.getElementById('toolbox'),
  collapse : false, 
	comments : true, 
	disable : true, 
	maxBlocks : Infinity, 
	trashcan : true, 
	horizontalLayout : false, 
	toolboxPosition : 'start', 
	css : true, 
	scrollbars : true, 
	sounds : true, 
	oneBasedIndex : false, 
	grid : {
		spacing : 20, 
		length : 1, 
		colour : '#888', 
		snap : false
	}, 
	zoom : {
		controls : true, 
		wheel : true, 
		startScale : 1, 
		maxScale : 1.5, 
		minScale : 0.2, 
		scaleSpeed : 1.2
	}
});
  var onresize = function(e) {
    // Compute the absolute coordinates and dimensions of blocklyArea.
    var element = blocklyArea;
    var x = 0;
    var y = 0;
    do {
      x += element.offsetLeft;
      y += element.offsetTop;
      element = element.offsetParent;
    } while (element);
    // Position blocklyDiv over blocklyArea.
    blocklyDiv.style.left = x + 'px';
    blocklyDiv.style.top = y + 'px';
    blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
    blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
    Blockly.svgResize(workspace);
  };
  window.addEventListener('resize', onresize, false);
  onresize();
  Blockly.svgResize(workspace);
	
function myUpdateFunction(event) {
  var code = Blockly.JavaScript.workspaceToCode(workspace);
  document.getElementById('textarea').value = code;
}
workspace.addChangeListener(myUpdateFunction);
</script>
  </body>


</html>
